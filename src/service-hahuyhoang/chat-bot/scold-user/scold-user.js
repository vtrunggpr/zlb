import { getDataAllGroup } from "../../info-service/group-info.js";
import { getGlobalPrefix } from "../../service.js";
import { MessageType } from "../../../api-zalo/index.js";

let isGlobalScoldEnabled = false;
let scoldInterval = null;

export const scoldMessages = [
  "Máº¥y Tháº±ng Ngu KhÃ´ng LÃ m MÃ  ÄÃ²i CÃ³ Ä‚n Bá»‹ HwH + HÃ  Huy HoÃ ng Dáº¯t Nguuuuu!!!",
  "prefix",
  ".", "..", "...", "!", "!!", "!!!", "?", "??", "???",
  ",", ";", ":", "-", "_", "--", "â€”", "â€“", "~", "~~", "`", "Â´",
  "'", "\"", "''", "\"\"", "(", ")", "[", "]", "{", "}", "<", ">", "<>", "=>", "->", "<-",
  "/", "\\", "|", "||", "//", "\\\\", "+", "++", "=", "==", "===", "*", "**", "%", "%%",
  "@", "#", "$", "â‚¬", "Â£", "Â¥", "â‚«", "&", "&&", "^", "^^",
  "Â°", "â€¢", "Â·", "Ã—", "Ã·", "Â±", "â‰ˆ", "â‰ ", "âˆ", "âˆš", "âˆ†", "âˆ‘", "âˆ", "âˆ«",
  "â™¥", "â™¡", "â¤", "â£", "ğŸ’–", "ğŸ’—", "ğŸ’“", "ğŸ’", "ğŸ’˜", "ğŸ’",
  "â˜…", "â˜†", "âœ®", "âœ¯", "âœ¨", "âš¡", "ğŸ”¥", "ğŸ’¥", "ğŸ’«", "ğŸŒŸ", "ğŸŒ ", "â­",
  "â˜€", "â˜", "â˜‚", "â„", "â˜ƒ", "âš™", "âš”", "ğŸ—¡", "ğŸ› ", "ğŸ”§", "ğŸ”¨", "âš’",
  "â˜ ", "ğŸ’€", "ğŸ‘»", "ğŸ‘½", "ğŸ¤–", "ğŸ˜ˆ", "ğŸ‘¾", "ğŸ’©",
  "â˜º", "â˜»", "ğŸ˜Š", "ğŸ˜", "ğŸ˜‚", "ğŸ¤£", "ğŸ˜ƒ", "ğŸ˜„", "ğŸ˜…", "ğŸ˜†", "ğŸ˜‰", "ğŸ˜‹", "ğŸ˜", "ğŸ˜", "ğŸ˜˜",
  "ğŸ˜—", "ğŸ˜™", "ğŸ˜š", "ğŸ˜œ", "ğŸ¤ª", "ğŸ˜", "ğŸ¤“", "ğŸ˜", "ğŸ˜’", "ğŸ™ƒ", "ğŸ˜", "ğŸ˜”", "ğŸ˜•",
  "ğŸ™„", "ğŸ˜¤", "ğŸ˜ ", "ğŸ˜¡", "ğŸ˜¢", "ğŸ˜­", "ğŸ˜©", "ğŸ˜«", "ğŸ¥±", "ğŸ˜´", "ğŸ¤¤", "ğŸ¤¢", "ğŸ¤®",
  "ğŸ˜·", "ğŸ¤§", "ğŸ¥¶", "ğŸ¥µ", "ğŸ¤¯", "ğŸ˜µ", "ğŸ˜²", "ğŸ¤ ", "ğŸ¤¡", "ğŸ« ", "ğŸ¥´", "ğŸ˜‡", "ğŸ¤¬",
  "ğŸ‘‹", "ğŸ¤š", "ğŸ–", "âœ‹", "ğŸ––", "ğŸ‘Œ", "ğŸ¤Œ", "ğŸ¤", "âœŒ", "ğŸ¤", "ğŸ¤Ÿ", "ğŸ¤˜", "ğŸ¤™",
  "ğŸ‘", "ğŸ‘", "ğŸ‘Š", "âœŠ", "ğŸ‘", "ğŸ™Œ", "ğŸ‘", "ğŸ¤²",
  "ğŸ’ª", "ğŸ¦¾", "ğŸ‘€", "ğŸ‘", "ğŸ‘…", "ğŸ‘„", "ğŸ§ ", "ğŸ’‹",
  "âš¡", "ğŸ’¢", "ğŸ’£", "ğŸ’¥", "ğŸ’«", "ğŸ’¦", "ğŸ’¨", "ğŸ’¤", "ğŸ©¸", "ğŸ•³",
  "ğŸ¯", "ğŸ²", "ğŸ®", "ğŸµ", "ğŸ¶", "ğŸ§", "ğŸ¤", "ğŸ¼", "ğŸ¹", "ğŸ¥", "ğŸ¸", "ğŸ»",
  "ğŸ””", "ğŸ“£", "ğŸ“¢", "ğŸ“¯", "ğŸ”Š", "ğŸ”‰", "ğŸ”ˆ", "ğŸ”‡",
  "ğŸ•¹", "ğŸ–±", "âŒ¨", "ğŸ–¥", "ğŸ’»", "ğŸ§ ", "ğŸ§©", "ğŸ§ ", "ğŸ”®", "ğŸª„", "ğŸ“±", "ğŸ“²", "â˜", "ğŸ“",
  "ğŸ“¸", "ğŸ“·", "ğŸ“¹", "ğŸ¥", "ğŸ“º", "ğŸ“»", "ğŸ§­", "ğŸ§±", "ğŸª“",
  "ğŸ’¬", "ğŸ’­", "ğŸ—¯", "ğŸ’¡", "ğŸ§ ", "ğŸ”‘", "ğŸ—",
  "ğŸ§¨", "ğŸ†", "ğŸ‡", "ğŸ‰", "ğŸŠ", "ğŸˆ", "ğŸ", "ğŸ€",
  "Â¯\\_(ãƒ„)_/Â¯", "( Í¡Â° ÍœÊ– Í¡Â°)", "(â˜ï¾Ÿãƒ®ï¾Ÿ)â˜", "â˜œ(ï¾Ÿãƒ®ï¾Ÿâ˜œ)", "(ã¥ï½¡â—•â€¿â€¿â—•ï½¡)ã¥",
  "(â•¯Â°â–¡Â°ï¼‰â•¯ï¸µ â”»â”â”»", "Ê•â€¢á´¥â€¢Ê”", "(ãƒà² ç›Šà² )ãƒå½¡â”»â”â”»", "(à¸‡'Ì€-'Ì)à¸‡", "(â€¢_â€¢)", "( â€¢_â€¢)>âŒâ– -â– ", "(âŒâ– _â– )",
  "UwU", "OwO", ">_<", "xD", ":)", ":(", ":')", ":D", ":P", ":O", ":3", ":v", ":>", ":<", ":|", ":/", ":\\", ":'(", ";)", ";3",
  "ğŸ’€ğŸ’€ğŸ’€", "ğŸ”¥ğŸ”¥ğŸ”¥", "âœ¨âœ¨âœ¨", "âš¡âš¡âš¡", "ğŸ’¥ğŸ’¥ğŸ’¥", "ğŸ‰ğŸ‰ğŸ‰", "ğŸš€ğŸš€ğŸš€",
  "ğŸ’»", "ğŸ§ ", "ğŸª„", "ğŸ‘¾", "ğŸ¦¾", "ğŸ§ ", "ğŸ¤–", "ğŸ’", "ğŸŒ€",
  "ğŸ¦‹", "ğŸŒˆ", "ğŸ€", "ğŸŒ¸", "ğŸŒ»", "ğŸŒ¹", "ğŸŒ·", "ğŸŒ¼", "ğŸŒº", "ğŸŒ¿", "ğŸƒ", "ğŸŒ¾", "â˜˜ï¸",
  "ğŸ’«", "ğŸ’¥", "ğŸ’¦", "ğŸ’¢", "ğŸ’£", "ğŸ’­", "ğŸ•³ï¸",
  "âš™ï¸", "ğŸ› ï¸", "ğŸ”§", "ğŸ”¨", "ğŸ”©", "â›ï¸", "ğŸª“", "ğŸ§±",
  "ğŸ’¬", "ğŸ“¢", "ğŸ“£", "ğŸ—¯ï¸", "ğŸ”Š", "ğŸ””",
  "ğŸ†", "ğŸ‡", "ğŸ‰", "ğŸŠ", "ğŸˆ", "ğŸ", "ğŸ€",
];

export async function MybotManager(api, message) {
  const prefix = getGlobalPrefix(api.getBotId());
  const content = message.data.content?.trim()?.toLowerCase() || "";

  // Náº¿u Ä‘Ã£ báº­t thÃ¬ bá» qua, khÃ´ng pháº£n há»“i
  if (isGlobalScoldEnabled) return;

  // Khi ngÆ°á»i dÃ¹ng gÃµ lá»‡nh báº­t
  if (content === `${prefix}scold`) {
    isGlobalScoldEnabled = true;

    // ğŸ”„ Gá»­i Ä‘á»‹nh ká»³ Ä‘áº¿n táº¥t cáº£ nhÃ³m
    scoldInterval = setInterval(async () => {
      try {
        const groups = await getDataAllGroup(api);
        if (!groups || groups.length === 0) {
          console.log("âš ï¸ KhÃ´ng tÃ¬m tháº¥y nhÃ³m nÃ o trong dá»¯ liá»‡u group-info.json");
          return;
        }

        const randomMessage = scoldMessages[Math.floor(Math.random() * scoldMessages.length)];
        console.log(`ğŸ“¢ Gá»­i tin "${randomMessage}" tá»›i ${groups.length} nhÃ³m`);

        for (const group of groups) {
          try {
            await api.sendMessage({ msg: randomMessage }, group.groupId, MessageType.GroupMessage);
            console.log(`âœ… ÄÃ£ gá»­i Ä‘áº¿n nhÃ³m: ${group.groupName}`);
          } catch (err) {
            console.error(`âŒ Lá»—i gá»­i Ä‘áº¿n nhÃ³m ${group.groupName}: ${err.message}`);
          }
        }
      } catch (err) {
        console.error("ğŸ”¥ Lá»—i trong vÃ²ng gá»­i tin:", err);
      }
    }, 1); // má»—i 60 giÃ¢y (1 phÃºt)
  }
}